<!doctype html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
		<title>API调用演示</title>
        <style>
            div,textarea{font-size:12px;font-family:menlo,monaco,consolas}
            textarea{width:600px;height:500px;}
            .code{display:none;}
        </style>
        <!--[if lt IE 9 ]>
        <script src="../tools/firebug-lite/content/firebug-lite-dev.js"></script>
        <![endif]-->
        <script src="../build/all.js"></script>
        <script>

            // 初始化库
            T.init({appkey: "key001"});

            // 取数据失败
            function apiSuccess(response) {
                document.getElementById("result").innerHTML = response;
            }

            // 取数据成功
            function apiError(code, message) {
                document.getElementById("result").innerHTML = code + "," + message;
            }

            // 动作绑定
            T.documentReady(function () {
                document.getElementById("exec").onclick = function () {
                    var command = document.getElementById("command").value,
                        params = document.getElementById("parameters").value,
                        format = document.getElementById("_format").value,
                        method = document.getElementById("_method").value;

                    params = T.queryString.decode(params,",");

                    document.getElementById("result").innerHTML = "处理中...";

                    T.api(command,params,format,method)
                     .success(apiSuccess)
                     .error(apiError);
                };
            });

        </script>
	</head>
    <!--[if lt IE 7 ]><body class="ie_6"><![endif]-->
    <!--[if IE 7 ]><body class="ie_7"><![endif]-->
    <!--[if IE 8 ]><body class="ie_8"><![endif]-->
    <!--[if IE 9 ]><body class="ie_9"><![endif]-->
    <!--[if (gt IE 9)|!(IE)]><!-->
    <body>
    <!--<![endif]-->
    <p>
    <label for="command">接口:</label>
    <input id="command" type="text" value="/statuses/home_timeline"></input>
    </p>

    <p>
    <label for="parameters">参数:</label>
    <input id="parameters" type="text" value=""></input>
    如: foo=bar, abc=def
    </p>

    <p>
    <label for="format">格式:</label>
    <input type="hidden" name="_format" value="json"></input>
    <input type="radio" id="format" name="format" value="json" onclick="document.getElementById("_format").value=this.value;" checked>json</input>
    <input type="radio" name="format" value="xml" onclick="document.getElementById("_format").value=this.value;">xml</input>
    <input type="radio" name="format" value="text" onclick="document.getElementById("_format").value=this.value;">text</input>
    </p>

    <p>
    <label for="method">方法:</label>
    <input type="hidden" name="_method" value="get"></input>
    <input type="radio" id="method" name="method" value="get" onclick="document.getElementById("_method").value=this.value;" checked>GET</input>
    <input type="radio" name="method" value="post" onclick="document.getElementById("_method").value=this.value;">POST</input>
    </p>

    <p>
    <button id="exec">执行</button>
    </p>

    <p>
    <div class="result" id="result"></div>
    </p>

    <p><a href="#" onclick="document.getElementById("code").style.display='block';">显示代码</a></p>
    <p class="code" id="code">
    <textarea>

            // 初始化库
            T.init({appkey: "key001"});

            // 取数据失败
            function apiSuccess(response) {
                document.getElementById("result").innerHTML = response;
            }

            // 取数据成功
            function apiError(code, message) {
                document.getElementById("result").innerHTML = code + "," + message;
            }

            // 动作绑定
            T.documentReady(function () {
                document.getElementById("exec").onclick = function () {
                    var command = document.getElementById("command").value,
                        params = document.getElementById("parameters").value,
                        format = document.getElementById("_format").value,
                        method = document.getElementById("_method").value;

                    params = T.queryString.decode(params,",");

                    document.getElementById("result").innerHTML = "处理中...";

                    T.api(command,params,format,method)
                     .success(apiSuccess)
                     .error(apiError);
                };
            });
    </textarea>
    </p>
	</body>
</html>

