<!doctype html>
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="zh-CN"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="zh-CN"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="zh-CN"> <![endif]-->
<!--[if gt IE 8]><!--><html class="no-js" lang="zh-CN"> <!--<![endif]-->
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<title>openJS文档</title>
	<style>
		body {font-size:14px;line-height:22px;font-family:Helvetica, Arial, "Microsoft YaHei",sans-serif;background:#f4f4f4;padding:0;margin:0;}
		a:link,a:visited{color: black;text-decoration:none;}
        a:hover {text-decoration: underline;}
        a:active {color:#06c;}
		ul{list-style-type:circle;}
		ul li{margin-top:10px;}
        h2 {display:block;padding:20px 0px;}
        sup{font-family:verdana,Arial,sans-serif;}
        sup a:link,sup a:visited{color:#06c;text-decoration:none;}
        sup a:hover,sup a:active{color:#06c;text-decoration:underline;}

		pre.code{font-family:Monaco, Consolas, "Lucida Console", monospace;font-size:12px;line-height:20px;border-left:5px solid #ccc;border-right:5px solid #ccc;padding: 5px 10px;margin:25px 0px;display:block;position:relative;}
        span.code{font-family:Monaco, Consolas, "Lucida Console", monospace;font-size:12px;margin-left:20px;}
        div.run{position:absolute;right:15px;width:26px;height:18px;top:0;background:url("./images/run.png") no-repeat -26px 0px;cursor:pointer;cursor:hand;}

		.aside{background:#fff;position:fixed;top:0;left:0;bottom:0;width:150px;overflow-x:hidden;overflow-y:auto;padding:15px 0px 30px 30px;border-right:1px solid #bbb;box-shadow: 0 0 20px #ccc;z-index:3;}
        .aside .version {font-size: 10px;font-weight: normal;}
		.aside a{text-decoration:underline;}
        a.toc_title{display: block;margin-top: 10px;font-weight:bold;}
		.aside .toc_section{list-style-type:none;padding:0px;margin:5px 0 0 5px;}

		.bside{position:fixed;top:0;right:0;bottom:0;width:100%;height:100%;z-index:1;background:#f4f4f4;}
        .bside .snippetview{margin-left:740px;height:100%;}

		.content{position:relative;margin:0px 0 50px 210px;width:500px;word-wrap:break-word;word-break:break-all;z-index:2;text-shadow:0px 1px #fff;}
		.content p{text-indent:28px;line-height:30px;}
		.content .caution{background:#f5f5f5;}
		.content a{text-decoration:underline;}
        .content .options{background:#eee;padding:10px 0px;}
        .content .options .opttype{float:right;}
		.content .options p{text-indent:0;font-weight:normal;line-height:16px;}
        .content .options .argument{width:95%;margin:10px auto 0px auto;font-size:14px;font-weight:bold;}
        .content .options .option{width:90%;margin:10px auto 0px auto;padding-top:10px;font-size:12px;font-weight:bold;border-top:1px solid #ddd;}
        .content .options .option .desc{font-weight:normal;}
        .content .options .optdefault{color:#666;}
		span.optrequired{color:#666;padding-left:10px;}

        p.intro{text-indent:0;}
        b.header{font-size:18px;line-height:35px;}

	</style>
	<script>
        function showSnippet( url ) {
            var f = document.getElementById('snippetframe');
            f.src = ['./snippet/snippet.html', '?', 'q=', url].join("");
            f.style.borderLeft="1px solid #bbb";
            f.style.boxShadow="0 0 20px #ccc";
        }

        function closeSnippet() {
            var f = document.getElementById('snippetframe');
            f.src = "about:blank";
            f.style.borderLeft="none";
            f.style.boxShadow="none";
        }
    </script>
</head>
<body>
    <div class="aside">

		<a class="toc_title" href="#" lang="en">OpenJS <span class="version"> (2.0)</span></a>

		<a class="toc_title" href="#开始使用">开始使用</a>

		<a class="toc_title" href="#环境变量">环境变量</a>

		<a class="toc_title" href="#开放平台API调用">开放平台API调用</a>

		<ul class="toc_section">
			<li>- <a href="#init">init</a></li>
        </ul>

		<a class="toc_title" href="#网站连接">网站连接</a>

		<ul class="toc_section">
			<li>- <a href="#component">微评论</a></li>
        </ul>

		<a class="toc_title" href="#应用频道接入">应用频道接入</a>

		<ul class="toc_section">
			<li>- <a href="">component</a></li>
        </ul>

		<a class="toc_title" href="#历史更新">历史更新</a>

		<a class="toc_title" href="#常见问题">常见问题</a>

	</div>
    <div class="content">
		<h2>OpenJS</h2>
		<p>OpenJS是腾讯微博开放平台提供的Javascript库，开发者使用该库可以轻松完成腾讯微博用户授权，访问API接口，调用官方组件等功能。目前已有这些应用在使用OpenJS。</p>

		<h2>升级说明</h2>
		<p>2.0版本相对上一版本的主要变动如下：</p>
		<ul>
			<!--<li>支持全新的OAuth2.0协议</li>-->
			<li>增加 <a href="#环境变量">环境变量</a> 设置</li>
			<li>增加 <a href="#模板">模版</a> 方法</li>
			<li>增加 <a href="#模板">网站连接</a> 组件调用</li>
			<!--<li><a href="#init">init</a> 方法中支持更多的控制参数</li>-->
			<!--<li>允许独立调用 <a href="#api">api</a> 方法</li>-->
			<li>进一步增强兼容性</li>
		</ul>


		<h2 id="开始使用">开始使用</h2>
		<p>在页面中引用OpenJS的方式分同步引用和异步引用两种。若用同步引用的方式，为优化网站性能，建议将OpenJS放置在页面底部加载<sup><a target="_blank" href="http://developer.yahoo.com/performance/rules.html#js_bottom">[1]</a></sup>。若用异步引用的方式，开发者须进行异步编程。开发者可根据自己的项目情况，自由选择。</p>
		<ul>
			<li>同步引用
<pre class="code">
<div class="run" onmouseover='this.style.backgroundPosition="0px 0px";' onmousedown='this.style.backgroundPosition="-51px 0px";' onmouseup='this.style.backgroundPosition="-26px 0px";' onmouseout='this.style.backgroundPosition="-26px 0px";' onclick='showSnippet("sync_reference.html")'></div>
&lt;script src="//mat1.gtimg.com/app/openjs/openjs.js"&gt;&lt;/script&gt;
&lt;script&gt;
    // 同步引用，无需回调函数
    // 你的代码
&lt;/script&gt;
</pre>
		    </li>
			<li>异步引用
<pre class="code">
<div class="run" onmouseover='this.style.backgroundPosition="0px 0px";' onmousedown='this.style.backgroundPosition="-51px 0px";' onmouseup='this.style.backgroundPosition="-26px 0px";' onmouseout='this.style.backgroundPosition="-26px 0px";' onclick='showSnippet("async_reference.html")'></div>
&lt;script&gt;
    // 异步引用需定义回调函数 <a id="onOpenjsLoad" href="#onOpenjsLoad">onOpenjsLoad</a>
    window['onOpenjsLoad'] = function () {
        alert("openJS加载成功");
    }

    (function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) {return;}
      js = d.createElement(s); js.id = id;
      js.src = "//mat1.gtimg.com/app/openjs/openjs.js";
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'openjs'));
&lt;/script&gt;
</pre>
    	    </li>
		</ul>

		<h2 id="环境变量">环境变量</h2>
		<p>OpenJS默认的运行环境参数配置基于大多数人的需要，一般情况下不需要做任何设置。在某些特殊情况下，开发者可以通过设置环境变量，改变OpenJS的默认行为。环境变量以Fragment URL<sup><a target="_blank" href="http://www.w3.org/TR/WD-html40-970708/htmlweb.html#h-4.1.1">[2]</a></sup>的形式传递，不区分大小写。</p>
<pre class="code">
<div class="run" onmouseover='this.style.backgroundPosition="0px 0px";' onmousedown='this.style.backgroundPosition="-51px 0px";' onmouseup='this.style.backgroundPosition="-26px 0px";' onmouseout='this.style.backgroundPosition="-26px 0px";' onclick='showSnippet("envs.html")'></div>
&lt;script src="//mat1.gtimg.com/app/openjs/openjs.js#debug=yes"&gt;&lt;/script&gt;
</pre>
        <!--
		<div class="options">
			<div class="argument">QQWBENVS<span class="opttype">Map</span><div>默认值:undefined</div><p>OpenJS环境变量对象</p></div>
			<div class="option">Debug<span class="opttype">Boolean</span><div>默认值:false(不开启调试模式)</div><p>开启Debug模式有助于跟踪调试，建议在开发过程中开启。</p></div>
			<div class="option">LogLevel<span class="opttype">Number</span><div>默认值:0(输出全部日志)</div><p>该值越大意味着输出Log输出的信息越少也越重要，默认输出尽可能详细的Log。</p></div>
			<div class="option">CrossDomainMethod<span class="opttype">String</span><div>默认值:''(自动检测)</div><p>该参数可指定跨域解决方案。默认情况下OpenJS自动检测当前浏览器，并适配一种最优的方案，如果你十分确定要采用的跨域解决方案可以指定该参数。<div class="option">html5 <span class="desc">采用postmessage的方式跨域</span></div><div class="option">flash <span class="desc">采用嵌入flash的方式跨域</span></div></p></div>
			<div class="option">CookieDomain<span class="opttype">String</span><div>默认值:''</div><p>OpenJS需要使用Cookie保存用户的授权信息，该参数可以控制Cookie的domain域。</p></div>
			<div class="option">CookiePath<span class="opttype">String</span><div>默认值:'/'</div><p>同CookieDomain一样，该参数控制Cookie的path字段。假如你不想把腾讯微博用户授权信息保存在根域下，请设置此环境变量控制。</p></div>
		</div>
		-->

		<div class="options">
			<div class="argument"></div>
			<div class="option">debug<span class="opttype">Boolean</span><div class="optdefault">默认值:false(不开启调试模式)</div><p>开启Debug模式有助于跟踪调试，建议在开发过程中开启。</p></div>
			<div class="option">logLevel<span class="opttype">Number</span><div class="optdefault">默认值:0(输出全部日志)</div><p>值越大意味着输出Log输出的信息越少越重要，默认输出尽可能详细的Log。</p></div>
			<div class="option">crossDomainMethod<span class="opttype">String</span><div class="optdefault">默认值:'auto'(自动检测)</div><p>该参数可指定跨域解决方案。默认情况下OpenJS自动检测当前浏览器，并适配一种最优的方案，如果你十分确定要采用的跨域解决方案可以指定该参数。<div class="option">html5 <span class="desc">使用postmessage跨域</span></div><div class="option">flash <span class="desc">内嵌flash代理跨域(要求Flash Player 9以上)</span></div></p></div>
			<div class="option">cookieDomain<span class="opttype">String</span><div class="optdefault">默认值:''</div><p>OpenJS需使用Cookie保存用户的授权信息，此参数可以控制Cookie的domain域。</p></div>
			<div class="option">cookiePath<span class="opttype">String</span><div class="optdefault">默认值:'/'</div><p>与cookieDomain一样，此参数控制Cookie的path字段。如果你不想把腾讯微博用户授权信息保存在根域下，请设置此环境变量进行控制。</p></div>
			<div class="option">autoboot<span class="opttype">Boolean</span><div class="optdefault">默认值:true(尽早加载跨域方案)</div><p>为真时先于init方法加载跨域方案，为假时等init执行时再加载跨域方案。</p></div>
		</div>

		<h2 id="开放平台API调用">开放平台API调用</h2>
		<p id="init" class="intro"><b class="header">init</b><span class="code">T.init(inInitOpts)</span><br/>
		初始化。</p>

<pre class="code">
<div class="run" onmouseover='this.style.backgroundPosition="0px 0px";' onmousedown='this.style.backgroundPosition="-51px 0px";' onmouseup='this.style.backgroundPosition="-26px 0px";' onmouseout='this.style.backgroundPosition="-26px 0px";' onclick='showSnippet("init.html")'></div>
&lt;script&gt;
    T.init({
        appkey:800000006
    });
&lt;/script&gt;
</pre>

		<div class="options">
			<div class="argument">inInitOpts<span class="optrequired">必选</span><span class="opttype">Map</span></div>
			<div class="option">appkey<span class="optrequired">必选</span><span class="opttype">String</span><div class="optdefault">默认值:无</div><p>开放平台appkey，据协议和平台的差异性有时又叫appid或client id。</p></div>
			<div class="option">callbackurl<span class="opttype">String</span><div class="optdefault">默认值:当前页面网址</div><p>用户授权成功后的回跳页面地址，如不设置则为当前页面网址。回跳页面地址必须与appkey匹配<sup><a href="#">[3]</a></sup>，否则无法完成授权。</p></div>
			<div class="option">autoclose<span class="opttype">Boolean</span><div class="optdefault">默认值:true(自动关闭授权窗口)</div><p>默认自动关闭授权窗口，否则需开发者自行关闭回跳页面窗口。</p></div>
			<div class="option">samewindow<span class="opttype">Boolean</span><div class="optdefault">默认值:false(弹新窗口授权)</div><p>默认为弹新窗口授权，否则在同一窗口授权。</p></div>
<!-- 该字段将被废弃，并有新的用途
			<div class="option">synclogin<span class="opttype">Boolean</span><div class="optdefault">默认值:false(同步QQ登录态)</div><p>默认自动同步QQ登录态，当OAuth Token丢失或无效且无法通过refresh的方式获得新Token时，则同步QQ帐号登录态。</p></div>
-->
			<div class="option">pingback<span class="opttype">Boolean</span><div class="optdefault">默认值:true(发送报告)</div><p>向服务器发送质量或错误报告，帮助我们更好的完善OpenJS。为假时不向服务器发送任何数据，该参数也可以为数字，取值为1至3的整数，代表要发送报告的级别。</p></div>
		</div>

		<p id="login" class="intro"><b class="header">login</b><span class="code">T.login(inSuccessHandler,inFailHandler)</span><br/>
		用腾讯微博帐号登录授权应用，并根据授权结果回调相应函数。</p>

<pre class="code">
<div class="run" onmouseover='this.style.backgroundPosition="0px 0px";' onmousedown='this.style.backgroundPosition="-51px 0px";' onmouseup='this.style.backgroundPosition="-26px 0px";' onmouseout='this.style.backgroundPosition="-26px 0px";' onclick='showSnippet("login.html")'></div>
&lt;script&gt;
    T.login(function (loginStatus) {
        alert(loginStatus.nick);
    },function (loginError) {
        alert(loginError.message);
    });
&lt;/script&gt;
</pre>
		<div class="options">
		<div class="argument">inSuccessHandler(inLoginStatus)<span class="opttype">Function</span><div class="optdefault">默认值:无</div><p>用户登录授权成功后要执行的函数。</p></div>
			<div class="option">inLoginStatus<span class="opttype">Map</span><div class="optdefault">回调数据</div><p>包含用户登录信息。<div class="option">access_token <span class="desc">授权后获得的OAuth2.0 Accesstoken</span></div><div class="option">name <span class="desc">微博用户名</span></div><div class="option">nick <span class="desc">微博昵称</span></div></p></div>
		<div class="argument">inFailHandler(inLoginError)<span class="opttype">Function</span><div class="optdefault">默认值:无</div><p>用户登录授权失败后要执行的函数。</p></div>
			<div class="option">inLoginError<span class="opttype">Map</span><div class="optdefault">回调数据</div><p>包含的用户登录失败信息。<div class="option">message <span class="desc">失败原因描述</span></div></p></div>
        </div>

		<h2 id="网站连接">网站连接</h2>
		<p id="component" class="intro"><b class="header">component</b><span class="code">T.component(inComponentName)</span><br/>
		创建腾讯微博开放平台提供的网站连接组件。</p>

<pre class="code">
<div class="run" onmouseover='this.style.backgroundPosition="0px 0px";' onmousedown='this.style.backgroundPosition="-51px 0px";' onmouseup='this.style.backgroundPosition="-26px 0px";' onmouseout='this.style.backgroundPosition="-26px 0px";' onclick='showSnippet("sync_reference.html")'></div>
&lt;script src="//mat1.gtimg.com/app/openjs/openjs.js"&gt;&lt;/script&gt;
</pre>

	</div>
	<div class="bside">
    	<div class="snippetview">
			<iframe src="about:blank" id="snippetframe" frameBorder="0" width="100%" height="100%;"></iframe>
    	</div>
	</div>
</body>
</html>

